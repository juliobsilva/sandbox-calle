name: API Mgmt APIOPS Publisher

on:
  pull_request:
    branches: [main, develop]
    types: closed

  workflow_dispatch:
    inputs:
      # destination-enviroment:
      #   type: choice
      #   required: true
      #   options:
      #   - dev
      #   - hml
      #   - prod

      destination-enviroment:
        type: string
        required: true

      commit-id:
        type: string
        required: false

jobs:

  call-build-hml:
    uses:  juliobsilva/api-management/.github/workflows/apim-apiops-publisher.yaml@main
    with:
      destination-enviroment: "hml"
      commit-id: ${{ inputs.commit-id }}
    secrets: inherit

  call-build-prod:
    uses:  juliobsilva/api-management/.github/workflows/apim-apiops-publisher.yaml@main
    with:
      destination-enviroment: "prod"
      commit-id: ${{ inputs.commit-id }}
    secrets: inherit